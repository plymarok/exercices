<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Italien LV2 - Verbes</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0; padding: 20px;
      background: linear-gradient(135deg, #f0f4ff, #fefefe);
      color: #333;
    }
    h1 {
      text-align: center; color: #2c3e50; font-size: 2.2em; margin-bottom: 10px;
    }
    .wrap { max-width: 850px; margin: 0 auto; }
    .question {
      background: #fff; padding: 20px; margin: 20px 0; border-radius: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,.08); transition: transform .2s ease;
    }
    .question:hover { transform: translateY(-3px); }
    input[type="text"] {
      width: 100%; padding: 12px; font-size: 1em; border-radius: 8px;
      border: 1px solid #ccd4e0; margin-top: 10px; box-sizing: border-box;
    }
    .btn {
      margin-top: 15px; padding: 12px 18px; border: none; border-radius: 8px;
      background: #0074D9; color: #fff; font-weight: bold; cursor: pointer; font-size: 1em;
      transition: background .3s ease, transform .2s ease;
    }
    .btn:hover { background: #005fa3; transform: translateY(-2px); }
    .btn-secondary { background: #6b7280; }
    .btn-secondary:hover { background: #4b5563; }
    #score { font-size: 20px; font-weight: bold; text-align: center; margin: 25px 0; color: #2c3e50; }
    .recap {
      background: #fdfdfd; padding: 12px 16px; margin: 8px 0; border-left: 6px solid #ccd4e0;
      border-radius: 8px; box-shadow: 0 3px 8px rgba(0,0,0,.05);
    }
    .recap b { color: #2c3e50; }
    .good { color: #2e7d32; font-weight: bold; }
    .bad { color: #c62828; font-weight: bold; }
    .toolbar { display: flex; gap: 10px; justify-content: center; margin-bottom: 10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Quiz Italien LV2 â€” Verbes</h1>

    <div class="toolbar">
      <button class="btn btn-secondary" onclick="resetQuiz()">ðŸ”„ Reset</button>
    </div>

    <div id="questionBox"></div>
    <div id="score"></div>
    <h3>RÃ©capitulatif :</h3>
    <div id="recap"></div>
  </div>

  <script>
    const bank = [
      // ESSERE
      { q: "Comment dit-on Â« je suis Â» en italien ?", a: "sono" },
      { q: "Comment dit-on Â« tu es Â» en italien ?", a: "sei" },
      { q: "Comment dit-on Â« il/elle est Â» en italien ?", a: "Ã¨" },
      { q: "Comment dit-on Â« nous sommes Â» en italien ?", a: "siamo" },
      { q: "Comment dit-on Â« vous Ãªtes Â» en italien ?", a: "siete" },
      { q: "Comment dit-on Â« ils/elles sont Â» en italien ?", a: "sono" },
      // AVERE
      { q: "Comment dit-on Â« jâ€™ai Â» en italien ?", a: "ho" },
      { q: "Comment dit-on Â« tu as Â» en italien ?", a: "hai" },
      { q: "Comment dit-on Â« il/elle a Â» en italien ?", a: "ha" },
      { q: "Comment dit-on Â« nous avons Â» en italien ?", a: "abbiamo" },
      { q: "Comment dit-on Â« vous avez Â» en italien ?", a: "avete" },
      { q: "Comment dit-on Â« ils/elles ont Â» en italien ?", a: "hanno" },
      // FARE
      { q: "Comment dit-on Â« je fais Â» en italien ?", a: "faccio" },
      { q: "Comment dit-on Â« tu fais Â» en italien ?", a: "fai" },
      { q: "Comment dit-on Â« il/elle fait Â» en italien ?", a: "fa" },
      { q: "Comment dit-on Â« nous faisons Â» en italien ?", a: "facciamo" },
      { q: "Comment dit-on Â« vous faites Â» en italien ?", a: "fate" },
      { q: "Comment dit-on Â« ils/elles font Â» en italien ?", a: "fanno" },
      // ANDARE
      { q: "Comment dit-on Â« je vais Â» en italien ?", a: "vado" },
      { q: "Comment dit-on Â« tu vas Â» en italien ?", a: "vai" },
      { q: "Comment dit-on Â« il/elle va Â» en italien ?", a: "va" },
      { q: "Comment dit-on Â« nous allons Â» en italien ?", a: "andiamo" },
      { q: "Comment dit-on Â« vous allez Â» en italien ?", a: "andate" },
      { q: "Comment dit-on Â« ils/elles vont Â» en italien ?", a: "vanno" },
      // POTERE
      { q: "Comment dit-on Â« je peux Â» en italien ?", a: "posso" },
      { q: "Comment dit-on Â« tu peux Â» en italien ?", a: "puoi" },
      { q: "Comment dit-on Â« il/elle peut Â» en italien ?", a: "puÃ²" },
      { q: "Comment dit-on Â« nous pouvons Â» en italien ?", a: "possiamo" },
      { q: "Comment dit-on Â« vous pouvez Â» en italien ?", a: "potete" },
      { q: "Comment dit-on Â« ils/elles peuvent Â» en italien ?", a: "possono" },
      // CHIAMARSI
      { q: "Comment dit-on Â« je mâ€™appelle Â» en italien ?", a: "mi chiamo" },
      { q: "Comment dit-on Â« tu tâ€™appelles Â» en italien ?", a: "ti chiami" },
      { q: "Comment dit-on Â« il/elle sâ€™appelle Â» en italien ?", a: "si chiama" },
      { q: "Comment dit-on Â« nous nous appelons Â» en italien ?", a: "ci chiamiamo" },
      { q: "Comment dit-on Â« vous vous appelez Â» en italien ?", a: "vi chiamate" },
      { q: "Comment dit-on Â« ils/elles sâ€™appellent Â» en italien ?", a: "si chiamano" }
    ];

    const STORAGE_KEY = "it_quiz_state_v1";

    const state = {
      indices: [], current: 0, score: 0, recap: [], finished: false
    };

    function shuffle(array) {
      const a = array.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function pick20Indices() {
      return shuffle([...Array(bank.length).keys()]).slice(0, 20);
    }

    function saveState() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }
    function loadState() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return false;
      Object.assign(state, JSON.parse(raw));
      return true;
    }
    function clearState() { localStorage.removeItem(STORAGE_KEY); }

    const questionBox = document.getElementById("questionBox");
    const recapDiv = document.getElementById("recap");
    const scoreDiv = document.getElementById("score");

    function renderRecap() {
      recapDiv.innerHTML = "";
      state.recap.forEach((r, idx) => {
        const bq = bank[r.i];
        const line = document.createElement("div");
        line.className = "recap";
        if (r.ok) {
          line.innerHTML = `<b>Q${idx+1} :</b> ${bq.q}<br/>RÃ©ponse : <span class="good">${bq.a}</span>`;
        } else {
          line.innerHTML = `<b>Q${idx+1} :</b> ${bq.q}<br/>Ta rÃ©ponse : <span class="bad">${r.user || "(vide)"}</span><br/>Correct : <span class="good">${bq.a}</span>`;
        }
        recapDiv.appendChild(line);
      });
      scoreDiv.textContent = `Score : ${state.score} / 20`;
    }

    function renderQuestion() {
      if (state.finished || state.current >= state.indices.length) {
        state.finished = true;
        saveState();
        questionBox.innerHTML =
          `<div class="question"><h2>Quiz terminÃ© ! Score final : ${state.score} / 20</h2></div>`;
        return;
      }
      const i = state.indices[state.current];
      const q = bank[i];
      questionBox.innerHTML = `
        <div class="question">
          <p><b>Question ${state.current + 1}/20 :</b> ${q.q}</p>
          <input type="text" id="answer" placeholder="RÃ©ponse en italien" autofocus />
          <button class="btn" onclick="submitAnswer()">${state.current === 19 ? "Terminer" : "Valider"}</button>
        </div>`;
    }

    function normalize(s) {
      return (s || "").toLowerCase().trim().replace(/â€™/g,"'");
    }

    function submitAnswer() {
      const input = document.getElementById("answer");
      const user = normalize(input.value);
      const i = state.indices[state.current];
      const correct = normalize(bank[i].a);
      const ok = user === correct;

      if (ok) state.score++;

      state.recap.push({ i, user: input.value, ok });
      state.current++;
      saveState();
      renderRecap();
      renderQuestion();
    }

    function startOrResume() {
      if (!loadState() || state.finished) {
        state.indices = pick20Indices();
        state.current = 0; state.score = 0; state.recap = []; state.finished = false;
        saveState();
      }
      renderRecap();
      renderQuestion();
    }

    function resetQuiz() {
      clearState();
      state.indices = pick20Indices();
      state.current = 0; state.score = 0; state.recap = []; state.finished = false;
      saveState();
      renderRecap();
      renderQuestion();
    }

    window.submitAnswer = submitAnswer;
    window.resetQuiz = resetQuiz;

    startOrResume();
  </script>
</body>
</html>

